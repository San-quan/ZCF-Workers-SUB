; 海外回国代理 (.ini 模板)
; 说明：此文件为 INI 模板形式的 Clash/Clash.Meta 配置（便于编辑/模板化）。
; 用途：优先把中国流量和 Speedtest 测试走“回国组”；其它流量走香港/海外。
; 请把所有示例节点(server/port/password/uuid 等)替换为你的真实节点信息后使用。

[General]
mixed-port = 7890
allow-lan = true
mode = rule
log-level = info
external-controller = 0.0.0.0:9090
secret =
ipv6 = true
unified-delay = true
tcp-concurrent = true
keep-alive-interval = 30

; -------------------------
; Proxies (示例节点 — 替换为真实节点)
; -------------------------
[Proxy:CN-1]
name = 🇨🇳回国节点1
type = ss
server = cn-server1.example.com
port = 443
cipher = chacha20-ietf-poly1305
password = your-cn-password
udp = true
ipv6 = true

[Proxy:CN-2]
name = 🇨🇳回国节点2
type = vmess
server = cn-server2.example.com
port = 443
uuid = your-cn-uuid
alterId = 0
cipher = auto
tls = true
udp = true
ipv6 = true

[Proxy:HK-1]
name = 🇭🇰香港节点1
type = trojan
server = hk-server1.example.com
port = 443
password = your-hk-password
sni = hk.example.com
udp = true
ipv6 = true

[Proxy:HK-2]
name = 🇭🇰香港节点2
type = ss
server = hk-server2.example.com
port = 443
cipher = aes-256-gcm
password = your-hk-password
udp = true
ipv6 = true

[Proxy:US-1]
name = 🇺🇸海外节点1
type = vmess
server = us-server1.example.com
port = 443
uuid = your-us-uuid
alterId = 0
cipher = auto
tls = true
udp = true
ipv6 = true

[Proxy:US-2]
name = 🇺🇸海外节点2
type = trojan
server = us-server2.example.com
port = 443
password = your-us-password
sni = us.example.com
udp = true
ipv6 = true

; -------------------------
; Proxy Groups
; - 回国组：url-test（用于回国优选/测速）
; - 香港组 / 海外组：url-test
; - 海外回国代理：select，方便手动/脚本指定“海外时回国出口”
; -------------------------
[ProxyGroup:CN]
name = 🇨🇳回国组
type = url-test
proxies = 🇨🇳回国节点1,🇨🇳回国节点2
url = http://www.gstatic.com/generate_204
interval = 300
tolerance = 50

[ProxyGroup:HK]
name = 🇭🇰香港组
type = url-test
proxies = 🇭🇰香港节点1,🇭🇰香港节点2
url = http://www.gstatic.com/generate_204
interval = 300
tolerance = 50

[ProxyGroup:US]
name = 🇺🇸海外组
type = url-test
proxies = 🇺🇸海外节点1,🇺🇸海外节点2
url = http://www.gstatic.com/generate_204
interval = 300
tolerance = 50

[ProxyGroup:ReturnToCN]
name = 海外回国代理
type = select
proxies = 🇨🇳回国节点1,🇨🇳回国节点2,DIRECT

; -------------------------
; DNS 配置
; -------------------------
[DNS]
enable = true
ipv6 = true
enhanced-mode = fake-ip
fake-ip-range = 198.18.0.1/16
nameserver = 114.114.114.114,8.8.8.8
fallback = https://dns.cloudflare.com/dns-query,https://doh.360.cn/dns-query
nameserver-policy.geosite:cn = 114.114.114.114
nameserver-policy.+.google.com = https://dns.cloudflare.com/dns-query

; -------------------------
; Rules (顺序保持重要性)
; - 中国 IP/常见中国域名走回国组
; - 常见国外服务走香港/海外组
; - SpeedtestChina 相关域名走回国组以便国内低延迟测速
; - 默认 MATCH 指向海外组（可改为 ReturnToCN / DIRECT）
; -------------------------
[Rules]
1 = GEOIP,CN,🇨🇳回国组
2 = DOMAIN-SUFFIX,cn,🇨🇳回国组
3 = DOMAIN-SUFFIX,baidu.com,🇨🇳回国组
4 = DOMAIN-SUFFIX,qq.com,🇨🇳回国组
5 = DOMAIN-SUFFIX,google.com,🇭🇰香港组
6 = DOMAIN-SUFFIX,youtube.com,🇭🇰香港组
7 = DOMAIN-SUFFIX,netflix.com,🇭🇰香港组
8 = DOMAIN-SUFFIX,facebook.com,🇺🇸海外组

; SpeedtestChina 优化（使 Speedtest.net/ookla 等走回国节点用于国内低延迟测试）
9 = DOMAIN-SUFFIX,speedtest.net,🇨🇳回国组
10 = DOMAIN-SUFFIX,speedtest.cn,🇨🇳回国组
11 = DOMAIN-SUFFIX,ookla.com,🇨🇳回国组
12 = DOMAIN-KEYWORD,speedtest,🇨🇳回国组

; 可选：把海外访问回国的流量强制走回国出口（把下面 MATCH 改为 ReturnToCN 即可）
13 = MATCH,🇺🇸海外组

; -------------------------
; Rule Providers (动态更新)
; -------------------------
[RuleProvider:speedtest-china]
type = http
behavior = domain
url = https://kelee.one/Tool/Clash/Rule/SpeedtestChina.yaml
path = ./ruleset/speedtest-china.yaml
interval = 43200
