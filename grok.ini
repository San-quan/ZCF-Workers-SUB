; ChinaDomain-BackCN-Overseas.ini - 2025 ç¼…ç”¸ Starlink Metaå†…æ ¸ä¼˜åŒ–ç‰ˆï¼Œå›å›½+æµ·å¤–åˆ†ç»„æ¨¡æ¿ï¼ˆè§„åˆ™ä¼˜åŒ–å¢å¼ºï¼‰
; ä½œè€…: è‰¾ç±³ (sanquan å¼€å‘è€…)
; ç‰ˆæœ¬: 1.7 (2025/10/14)
; ç”¨é€”: Subconverter ç”Ÿæˆ Clash Meta YAML - ä¸­å›½ app èµ°å›å›½ï¼Œéä¸­å›½èµ°é¦™æ¸¯/æµ·å¤–ï¼Œå…œåº•æµ·å¤– + OpenWRT æ¥å£åˆ†æµ + è§„åˆ™æ€§èƒ½ä¼˜åŒ–
; æ¥æº: ACL4SSR BackCN + Loyalsoldier GeoSite + Subconverter v0.9.10 + Metaå†…æ ¸v1.18+
; ä½¿ç”¨: Subconverter è¾“å…¥æ­¤ INI + è®¢é˜… URL ç”Ÿæˆ YAMLï¼Œè§„åˆ™æ¨¡å¼ï¼ŒFake-IP é˜²æ³„æ¼ï¼ŒTUNæµé‡æ§åˆ¶
; æ›´æ–°: interval=43200 (12h)ï¼Œè®¢é˜…è‡ªåŠ¨æ‹‰å– + url-test å»¶è¿Ÿæµ‹è¯• <20ms (è§„åˆ™ä¼˜åŒ–)
; ä¼˜åŒ–: IPv6 æ”¯æŒï¼ŒProxy Providers è®¢é˜…ï¼Œnameserver-policy DNS åˆ†æµ (MosDNSå…¼å®¹) + TUNæ¨¡å¼ + è§„åˆ™é¡ºåº/åˆå¹¶/æ‰©å±• (Apple/Netflix)

[general]
loglevel = info
append = false
skip-missed = true
tproxy = true  # OpenWRT TProxy/TUN å…¼å®¹ (Metaä¼˜å…ˆTUN)
error-report = true  # é”™è¯¯æ—¥å¿—
log-file = /tmp/subconverter.log  # è°ƒè¯•ç”¨

[rule_provider]
; ä¸­å›½ IP/åŸŸåè§„åˆ™æº (å›å›½ç»„ä»£ç†é€»è¾‘ï¼Œä¼˜åŒ–ï¼šåˆå¹¶baidu/tencent)
geoip-cn = type: http, behavior: classical, url: "https://raw.githubusercontent.com/Loyalsoldier/geoip/release/CN.txt", path: ./ruleset/geoip-cn.yaml, interval: 43200
geoip-cn-v6 = type: http, behavior: classical, url: "https://raw.githubusercontent.com/Loyalsoldier/geoip/release/CN_v6.txt", path: ./ruleset/geoip-cn-v6.yaml, interval: 43200  # IPv6
geosite-cn = type: http, behavior: classical, url: "https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geosite-cn.dat", path: ./ruleset/geosite-cn.yaml, interval: 43200

; ç”µå•†/æ”¯ä»˜/ç¤¾äº¤/çŸ­è§†é¢‘/æœç´¢å¼•æ“ (æ·˜å®ã€æ”¯ä»˜å®ã€å¾®ä¿¡ã€æŠ–éŸ³ã€å¿«æ‰‹ã€ç™¾åº¦ç­‰ï¼Œèµ°å›å›½ç»„ï¼›ä¼˜åŒ–ï¼šæ–°å¢apple-cn)
alibaba = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Alibaba.list", path: ./ruleset/alibaba.yaml, interval: 43200
jd = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/JD.list", path: ./ruleset/jd.yaml, interval: 43200
alipay = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Alipay.list", path: ./ruleset/alipay.yaml, interval: 43200
tencent-baidu = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Tencent.list", path: ./ruleset/tencent-baidu.yaml, interval: 43200  # åˆå¹¶å¾®ä¿¡/QQ/ç™¾åº¦
bilibili = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Bilibili.list", path: ./ruleset/bilibili.yaml, interval: 43200
douyin = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Douyin.list", path: ./ruleset/douyin.yaml, interval: 43200  # æŠ–éŸ³
kuaishou = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Kuaishou.list", path: ./ruleset/kuaishou.yaml, interval: 43200  # å¿«æ‰‹
meituan = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Meituan.list", path: ./ruleset/meituan.yaml, interval: 43200
didi = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/DiDi.list", path: ./ruleset/didi.yaml, interval: 43200
apple-cn = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Apple.list", path: ./ruleset/apple-cn.yaml, interval: 43200  # æ–°å¢ï¼šApple CN

; å¹¿å‘Š/å¢™å¤– (REJECT / æµ·å¤–ç»„ï¼›ä¼˜åŒ–ï¼šgfwæ‰©å±•Netflix)
banad = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/BanAD.list", path: ./ruleset/banad.yaml, interval: 43200
gfw-netflix = type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/GreatFire.list", path: ./ruleset/gfw-netflix.yaml, interval: 43200  # åˆå¹¶GFW+Netflix

[template]
; YAML å¤´éƒ¨ + é€šç”¨è®¾ç½® (mixed-port ç­‰ï¼ŒMeta TUNä¼˜åŒ–)
clash-config = |
  mixed-port: 7890
  allow-lan: true
  mode: rule
  log-level: info  # Metaä¼˜åŒ–ï¼šinfoå‡æ—¥å¿—è´Ÿè½½
  external-controller: 0.0.0.0:9090
  secret: ""
  ipv6: true
  tun:
    enable: true  # Meta TUNæ¨¡å¼ï¼šå…¨å±€æµé‡æ§åˆ¶ï¼Œæå‡å…¼å®¹
    stack: system  # systemæ ˆä¼˜åŒ–UDP
    dns-hijack:
      - any:53
    auto-route: true
    auto-detect-interface: true

; Proxy Providers (è®¢é˜…è‡ªåŠ¨æ›´æ–° + health-check å»¶è¿Ÿæµ‹è¯•<20msï¼ŒMetaåŠ å¯†å‡çº§)
proxy-providers = |
  china_subscription:
    type: http
    url: "${china_sub_url}"  # æ›¿æ¢: æ‚¨çš„ä¸­å›½è®¢é˜… URL
    interval: 1800  # Metaä¼˜åŒ–ï¼š30minæ›´æ–°ï¼Œå‡è´Ÿè½½
    health-check:
      enable: true
      url: "http://www.gstatic.com/generate_204"
      interval: 180  # 3minæ£€æŸ¥
      lazy: true  # Metaæ‡’åŠ è½½
  hongkong_subscription:
    type: http
    url: "${hk_sub_url}"  # æ›¿æ¢: é¦™æ¸¯è®¢é˜… URL
    interval: 1800
    health-check:
      enable: true
      url: "http://www.gstatic.com/generate_204"
      interval: 180
      lazy: true
  overseas_subscription:
    type: http
    url: "${overseas_sub_url}"  # æ›¿æ¢: æµ·å¤–è®¢é˜… URL
    interval: 1800
    health-check:
      enable: true
      url: "http://www.gstatic.com/generate_204"
      interval: 180
      lazy: true

; ç¤ºä¾‹ Proxies (è®¢é˜…è¦†ç›–ï¼›Metaæ”¯æŒtrojan-gsiç­‰æ–°åè®®)
proxies = |
  - name: ğŸ‡¨ğŸ‡³å›å›½èŠ‚ç‚¹
    type: ss
    server: ${CN_SERVER}
    port: ${CN_PORT}
    cipher: ${CN_ENCRYPTION}  # Metaä¼˜åŒ–ï¼šæ”¯æŒ2022-blake3
    password: ${CN_PASSWORD}
    udp: true
    ipv6: true
  - name: ğŸ‡­ğŸ‡°é¦™æ¸¯èŠ‚ç‚¹
    type: vmess
    server: ${HK_SERVER}
    port: ${HK_PORT}
    uuid: ${HK_UUID}
    alterId: 0
    cipher: auto
    tls: true
    network: ws
    ws-path: /ws
    ws-headers:
      Host: ${HK_HOST}
    udp: true
    ipv6: true
  - name: ğŸ‡ºğŸ‡¸æµ·å¤–æœ€ä¼˜
    type: trojan
    server: ${US_SERVER}
    port: ${US_PORT}
    password: ${US_PASSWORD}
    sni: ${US_SNI}
    udp: true
    ipv6: true

; Proxy Groups (url-test å»¶è¿Ÿæµ‹è¯•ï¼Œç¡®ä¿å¯ç”¨ï¼ŒMeta toleranceå‡è‡³15ms)
proxy-groups = |
  - name: ğŸ‡¨ğŸ‡³å›å›½ç»„
    type: url-test
    proxies:
      - china_subscription
      - ğŸ‡­ğŸ‡°é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡¸æµ·å¤–æœ€ä¼˜
    url: "http://www.gstatic.com/generate_204"
    interval: 180  # Metaä¼˜åŒ–ï¼š3min
    tolerance: 15  # <20msé˜ˆå€¼
  - name: ğŸ‡­ğŸ‡°é¦™æ¸¯ç»„
    type: url-test
    proxies:
      - hongkong_subscription
      - ğŸ‡ºğŸ‡¸æµ·å¤–æœ€ä¼˜
      - ğŸ‡¨ğŸ‡³å›å›½ç»„
    url: "http://www.gstatic.com/generate_204"
    interval: 180
    tolerance: 15
  - name: ğŸ‡ºğŸ‡¸æµ·å¤–ç»„
    type: url-test
    proxies:
      - overseas_subscription
      - ğŸ‡­ğŸ‡°é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¨ğŸ‡³å›å›½ç»„
    url: "http://www.gstatic.com/generate_204"
    interval: 180
    tolerance: 15

; DNS é…ç½® (Metaé‡æ„ï¼šåˆ†æµ+DoH fallback+nameserver-policyæ‰©å±•ï¼ŒMosDNSå…¼å®¹ï¼Œå‡å°‘é‡å¤æŸ¥è¯¢)
dns = |
  enable: true
  ipv6: true
  enhanced-mode: fake-ip  # Meta Fake-IPé˜²æ³„æ¼
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "+.lan"  # Metaä¼˜åŒ–ï¼šLANç›´è¿
    - "*.msftncsi.com"
    - "localhost.ptlogin2.qq.com"
  default-nameserver:
    - 114.114.114.114
    - 8.8.8.8
  nameserver:
    - 114.114.114.114
    - 223.5.5.5
    - tls://dns.rubyfish.cn:853  # Meta DoTæ”¯æŒ
  fallback:
    - https://dns.cloudflare.com/dns-query
    - https://doh.360.cn/dns-query
    - https://dns.google/dns-query
    - tls://1.1.1.1:853  # Metaå¢å¼ºfallback
  fallback-filter:
    geoip: false
    ipcidr:
      - 240.0.0.0/4
      - geoip:cn  # Metaï¼šCN fallbackè¿‡æ»¤
    geoip-code: CN
  nameserver-policy:
    "geosite:cn": 114.114.114.114  # CNç›´è¿DNS
    "+.google.com,+.*.goog": https://dns.cloudflare.com/dns-query
    "geosite:apple-cn": 114.114.114.114  # Apple CNåˆ†æµ
    "geosite:msft": 223.5.5.5  # Microsoftä¼˜åŒ–
    "netflix.com,*.netflix.com": https://dns.cloudflare.com/dns-query  # æ–°å¢ï¼šNetflix DNS

; Rule Providers (åŠ¨æ€æ‹‰å–ï¼Œä¼˜åŒ–ï¼šåˆå¹¶tencent-baidu/gfw-netflix)
rule-providers = |
  geoip-cn: type: http, behavior: classical, url: "https://raw.githubusercontent.com/Loyalsoldier/geoip/release/CN.txt", path: ./ruleset/geoip-cn.yaml, interval: 43200
  geoip-cn-v6: type: http, behavior: classical, url: "https://raw.githubusercontent.com/Loyalsoldier/geoip/release/CN_v6.txt", path: ./ruleset/geoip-cn-v6.yaml, interval: 43200
  geosite-cn: type: http, behavior: classical, url: "https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geosite-cn.dat", path: ./ruleset/geosite-cn.yaml, interval: 43200
  alibaba: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Alibaba.list", path: ./ruleset/alibaba.yaml, interval: 43200
  jd: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/JD.list", path: ./ruleset/jd.yaml, interval: 43200
  alipay: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Alipay.list", path: ./ruleset/alipay.yaml, interval: 43200
  tencent-baidu: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Tencent.list", path: ./ruleset/tencent-baidu.yaml, interval: 43200  # åˆå¹¶
  bilibili: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Bilibili.list", path: ./ruleset/bilibili.yaml, interval: 43200
  douyin: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Douyin.list", path: ./ruleset/douyin.yaml, interval: 43200
  kuaishou: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Kuaishou.list", path: ./ruleset/kuaishou.yaml, interval: 43200
  meituan: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Meituan.list", path: ./ruleset/meituan.yaml, interval: 43200
  didi: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/DiDi.list", path: ./ruleset/didi.yaml, interval: 43200
  apple-cn: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Apple.list", path: ./ruleset/apple-cn.yaml, interval: 43200
  banad: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/BanAD.list", path: ./ruleset/banad.yaml, interval: 43200
  gfw-netflix: type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/GreatFire.list", path: ./ruleset/gfw-netflix.yaml, interval: 43200  # åˆå¹¶

; è·¯ç”±è§„åˆ™ (ACL4SSR ä¼˜åŒ– + æ¥å£åˆ†æµ: é¡ºåºé‡æ’ - å…ˆæºIP/ç§æœ‰ > CNè§„åˆ™ > GFW/æµ·å¤– > å¹¿å‘Š > MATCHï¼›æ–°å¢Apple/Netflix)
backcn-rules = |
  ; æ¥å£åˆ†æµ (åŸºäºæºIPï¼Œä¼˜å…ˆçº§æœ€é«˜ï¼ŒMeta TUNæ”¯æŒ)
  - IP-CIDR6,fc00::/7,DIRECT,no-resolve  # æœ¬åœ°IPv6ç›´è¿
  - IP-CIDR,192.168.1.0/24,ğŸ‡¨ğŸ‡³å›å›½ç»„,no-resolve  # lan1/lan2
  - IP-CIDR,192.168.3.0/24,ğŸ‡ºğŸ‡¸æµ·å¤–ç»„,no-resolve  # lan3 (é¦™æ¸¯+æµ·å¤–)
  - IP-CIDR,192.168.4.0/24,DIRECT,no-resolve  # lan4 ç›´è¿
  - IP-CIDR,192.168.2.0/24,ğŸ‡­ğŸ‡°é¦™æ¸¯ç»„,no-resolve  # WiFi 5G
  ; ç§æœ‰ç½‘ç›´è¿å…œåº• (ä¼˜åŒ–ï¼šç§»åˆ°æºIPå)
  - IP-CIDR,192.168.0.0/16,DIRECT,no-resolve
  - IP-CIDR,10.0.0.0/8,DIRECT,no-resolve
  - IP-CIDR,172.16.0.0/12,DIRECT,no-resolve
  - IP-CIDR,100.64.0.0/10,DIRECT,no-resolve
  ; ä¸­å›½è§„åˆ™ (èµ°å›å›½ç»„ï¼Œä¼˜åŒ–ï¼šåˆå¹¶tencent-baidu)
  - RULE-SET,geoip-cn,ğŸ‡¨ğŸ‡³å›å›½ç»„
  - RULE-SET,geoip-cn-v6,ğŸ‡¨ğŸ‡³å›å›½ç»„
  - RULE-SET,geosite-cn,ğŸ‡¨ğŸ‡³å›å›½ç»„
  - RULE-SET,alibaba,ğŸ‡¨ğŸ‡³å›å›½ç»„
  - RULE-SET,jd,ğŸ‡¨ğŸ‡³å›å›½ç»„
  - RULE-SET,alipay,ğŸ‡¨ğŸ‡³å›å›½ç»„
  - RULE-SET,tencent-baidu,ğŸ‡¨ğŸ‡³å›å›½ç»„  # åˆå¹¶å¾®ä¿¡/QQ/ç™¾åº¦
  - RULE-SET,bilibili,ğŸ‡¨ğŸ‡³å›å›½ç»„
  - RULE-SET,douyin,ğŸ‡¨ğŸ‡³å›å›½ç»„
  - RULE-SET,kuaishou,ğŸ‡¨ğŸ‡³å›å›½ç»„
  - RULE-SET,meituan,ğŸ‡¨ğŸ‡³å›å›½ç»„
  - RULE-SET,didi,ğŸ‡¨ğŸ‡³å›å›½ç»„
  - RULE-SET,apple-cn,ğŸ‡¨ğŸ‡³å›å›½ç»„  # æ–°å¢Apple CN
  ; å¢™å¤–/æµ·å¤– (èµ°é¦™æ¸¯/æµ·å¤–ç»„ï¼Œä¼˜åŒ–ï¼šgfw-netflixå…¨é¦™æ¸¯ï¼ŒNetflixå…œåº•æµ·å¤–)
  - RULE-SET,gfw-netflix,ğŸ‡­ğŸ‡°é¦™æ¸¯ç»„  # åˆå¹¶GFW+Netflix
  - DOMAIN-SUFFIX,google.com,ğŸ‡­ğŸ‡°é¦™æ¸¯ç»„
  - DOMAIN-SUFFIX,youtube.com,ğŸ‡­ğŸ‡°é¦™æ¸¯ç»„
  - DOMAIN-SUFFIX,facebook.com,ğŸ‡ºğŸ‡¸æµ·å¤–ç»„
  - DOMAIN-SUFFIX,netflix.com,ğŸ‡ºğŸ‡¸æµ·å¤–ç»„  # Netflixæµ·å¤–ä¼˜åŒ–
  ; å¹¿å‘Šé˜»æŒ¡ (æœ«å°¾ï¼Œé¿å…å†²çª)
  - RULE-SET,banad,REJECT
  ; å…œåº• (Meta MATCHä¼˜åŒ–)
  - MATCH,ğŸ‡ºğŸ‡¸æµ·å¤–ç»„
